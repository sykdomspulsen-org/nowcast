<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nowcast">
<title>Simulating mortality data â€¢ nowcast</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating mortality data">
<meta property="og:description" content="nowcast">
<meta property="og:image" content="https://docs.sykdomspulsen.no/nowcast/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nowcast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2022.4.18</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/aggregation_and_delays.html">Data aggregation and reporting delays</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to nowcast</a>
    <a class="dropdown-item" href="../articles/simulate_mortality_data.html">Simulating mortality data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sykdomspulsen-org/nowcast/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulating mortality data</h1>
                        <h4 data-toc-skip class="author">Chi Zhang</h4>
            
            <h4 data-toc-skip class="date">2022-03-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sykdomspulsen-org/nowcast/blob/HEAD/../vignettes/simulate_mortality_data.Rmd" class="external-link"><code>../vignettes/simulate_mortality_data.Rmd</code></a></small>
      <div class="d-none name"><code>simulate_mortality_data.Rmd</code></div>
    </div>

    
    
<p>This document provides information on how to simulate mortality data. There are two kinds of mortality data: event and registration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.sykdomspulsen.no/nowcast">nowcast</a></span><span class="op">)</span>
<span class="co">#&gt; nowcast 2022.4.18</span>
<span class="co">#&gt; https://docs.sykdomspulsen.no/nowcast</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="simulate-mortality-event">Simulate mortality event<a class="anchor" aria-label="anchor" href="#simulate-mortality-event"></a>
</h1>
<p>We simulate mortality events (deaths) based on real-life mortality pattern in Norway. Each year there are roughly 43000 deaths in Norway (0.8%) in total, from 11 counties. There are seasonal variations as well: winter seasons have more deaths than the other seasons.</p>
<p>We simulate <strong>daily deaths for each county</strong>. Afterwards, it is convenient to aggregate by time (weekly, quarterly, yearly) and into national total.</p>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<div class="section level4">
<h4 id="simulate-directly-from-distribution">Simulate directly from distribution<a class="anchor" aria-label="anchor" href="#simulate-directly-from-distribution"></a>
</h4>
<p>There are two models to choose from:</p>
<ul>
<li>Poisson distribution</li>
<li>normal distribution approximation (rounded to integer, truncated at 0)</li>
</ul>
<p>Negative binomial distribution is also implemented, yet it is not ready for use.</p>
</div>
<div class="section level4">
<h4 id="simulate-from-model-to-include-seasonality">Simulate from model to include seasonality<a class="anchor" aria-label="anchor" href="#simulate-from-model-to-include-seasonality"></a>
</h4>
<p>(tbd)</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>use poisson model with 25 daily expected events</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specify time period</span>
<span class="va">start_date</span> <span class="op">&lt;-</span> <span class="st">'2018-01-01'</span>
<span class="va">end_date</span> <span class="op">&lt;-</span> <span class="st">'2019-12-31'</span>

<span class="co"># use poisson model with 25 daily expected events</span>
<span class="va">death_events_poi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_daily_death_event.html">simulate_daily_death_event</a></span><span class="op">(</span>
  start_date <span class="op">=</span> <span class="va">start_date</span>, 
  end_date <span class="op">=</span> <span class="va">end_date</span>, 
  model <span class="op">=</span> <span class="st">'poisson'</span>, 
  param_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">death_events_poi</span>
<span class="co">#&gt;           id       date</span>
<span class="co">#&gt;     1:     1 2018-01-01</span>
<span class="co">#&gt;     2:     2 2018-01-01</span>
<span class="co">#&gt;     3:     3 2018-01-01</span>
<span class="co">#&gt;     4:     4 2018-01-01</span>
<span class="co">#&gt;     5:     5 2018-01-01</span>
<span class="co">#&gt;    ---                 </span>
<span class="co">#&gt; 18043: 18043 2019-12-31</span>
<span class="co">#&gt; 18044: 18044 2019-12-31</span>
<span class="co">#&gt; 18045: 18045 2019-12-31</span>
<span class="co">#&gt; 18046: 18046 2019-12-31</span>
<span class="co">#&gt; 18047: 18047 2019-12-31</span></code></pre></div>
<p>Use Gaussian model (approximation) with mean 25 and standard deviation 2:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">death_events_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_daily_death_event.html">simulate_daily_death_event</a></span><span class="op">(</span>
  start_date <span class="op">=</span> <span class="va">start_date</span>, 
  end_date <span class="op">=</span> <span class="va">end_date</span>, 
  model <span class="op">=</span> <span class="st">'norm_approx'</span>, 
  param_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">25</span>, sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">death_events_norm</span>
<span class="co">#&gt;           id       date</span>
<span class="co">#&gt;     1:     1 2018-01-01</span>
<span class="co">#&gt;     2:     2 2018-01-01</span>
<span class="co">#&gt;     3:     3 2018-01-01</span>
<span class="co">#&gt;     4:     4 2018-01-01</span>
<span class="co">#&gt;     5:     5 2018-01-01</span>
<span class="co">#&gt;    ---                 </span>
<span class="co">#&gt; 18215: 18215 2019-12-31</span>
<span class="co">#&gt; 18216: 18216 2019-12-31</span>
<span class="co">#&gt; 18217: 18217 2019-12-31</span>
<span class="co">#&gt; 18218: 18218 2019-12-31</span>
<span class="co">#&gt; 18219: 18219 2019-12-31</span></code></pre></div>
<p>Count daily death events (with the possibility to visualize)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">death_count_poi</span> <span class="op">&lt;-</span> <span class="va">death_events_poi</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_event <span class="op">=</span> <span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">date</span><span class="op">]</span>
<span class="va">death_count_poi</span>
<span class="co">#&gt;            date n_event</span>
<span class="co">#&gt;   1: 2018-01-01      21</span>
<span class="co">#&gt;   2: 2018-01-02      31</span>
<span class="co">#&gt;   3: 2018-01-03      31</span>
<span class="co">#&gt;   4: 2018-01-04      27</span>
<span class="co">#&gt;   5: 2018-01-05      17</span>
<span class="co">#&gt;  ---                   </span>
<span class="co">#&gt; 726: 2019-12-27      26</span>
<span class="co">#&gt; 727: 2019-12-28      26</span>
<span class="co">#&gt; 728: 2019-12-29      24</span>
<span class="co">#&gt; 729: 2019-12-30      20</span>
<span class="co">#&gt; 730: 2019-12-31      17</span>
<span class="co"># death_count_norm &lt;- death_events_norm[, list(n_event = .N), by = date]</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="simulate-mortality-registration">Simulate mortality registration<a class="anchor" aria-label="anchor" href="#simulate-mortality-registration"></a>
</h1>
<p>Registration, or reporting is an important aspect in mortality data. Different reporting systems can have different delays after death event. For example, deaths that are registered electronically have shorter reporting delays (usually within days) than paper-based reports. Some deaths require post-morten (autopsy) to determine the cause of death, and can therefore take longer.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use the simulated death event data from the poisson model</span>
<span class="va">death_register</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_registration.html">simulate_registration</a></span><span class="op">(</span>death_data <span class="op">=</span> <span class="va">death_events_poi</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">death_register</span><span class="op">)</span>
<span class="co">#&gt;           id       date delay_days   date_reg</span>
<span class="co">#&gt;     1:     1 2018-01-01          7 2018-01-08</span>
<span class="co">#&gt;     2:     2 2018-01-01          9 2018-01-10</span>
<span class="co">#&gt;     3:     3 2018-01-01          9 2018-01-10</span>
<span class="co">#&gt;     4:     4 2018-01-01         11 2018-01-12</span>
<span class="co">#&gt;     5:     5 2018-01-01         15 2018-01-16</span>
<span class="co">#&gt;    ---                                       </span>
<span class="co">#&gt; 18043: 18043 2019-12-31          9 2020-01-09</span>
<span class="co">#&gt; 18044: 18044 2019-12-31         12 2020-01-12</span>
<span class="co">#&gt; 18045: 18045 2019-12-31          8 2020-01-08</span>
<span class="co">#&gt; 18046: 18046 2019-12-31         13 2020-01-13</span>
<span class="co">#&gt; 18047: 18047 2019-12-31          4 2020-01-04</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">death_register</span><span class="op">$</span><span class="va">delay_days</span><span class="op">)</span></code></pre></div>
<p><img src="simulate_mortality_data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># different parameters </span>
<span class="va">death_register2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_registration.html">simulate_registration</a></span><span class="op">(</span>death_data <span class="op">=</span> <span class="va">death_events_poi</span>, r <span class="op">=</span> <span class="fl">10</span>, p <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">death_register2</span><span class="op">$</span><span class="va">delay_days</span><span class="op">)</span></code></pre></div>
<p><img src="simulate_mortality_data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Crafted by Chi Zhang, Richard Aubrey White, Aurora Christine Hofman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
